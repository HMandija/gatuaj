{
  "version": 3,
  "sources": ["../../../../gatuaj/netlify/functions/paypal-create-order.js"],
  "sourceRoot": "C:/Users/User/AppData/Local/Temp/tmp-14136-aIj6s0VXFpHE",
  "sourcesContent": ["const base =\r\n  process.env.PAYPAL_ENV === \"live\"\r\n    ? \"https://api-m.paypal.com\"\r\n    : \"https://api-m.sandbox.paypal.com\";\r\n\r\nasync function getAccessToken() {\r\n  const client = process.env.VITE_PAYPAL_CLIENT_ID;\r\n  const secret = process.env.PAYPAL_CLIENT_SECRET;\r\n\r\n  const auth = Buffer.from(`${client}:${secret}`).toString(\"base64\");\r\n\r\n  const res = await fetch(`${base}/v1/oauth2/token`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      Authorization: `Basic ${auth}`,\r\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n    },\r\n    body: \"grant_type=client_credentials\",\r\n  });\r\n\r\n  const data = await res.json();\r\n  if (!res.ok) throw new Error(data?.error_description || \"PayPal token error\");\r\n  return data.access_token;\r\n}\r\n\r\nexport const handler = async (event) => {\r\n  try {\r\n    const { orderId, totalEur } = JSON.parse(event.body || \"{}\");\r\n    if (!orderId) throw new Error(\"Missing orderId\");\r\n    if (!totalEur) throw new Error(\"Missing totalEur\");\r\n\r\n    const accessToken = await getAccessToken();\r\n\r\n    const res = await fetch(`${base}/v2/checkout/orders`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        intent: \"CAPTURE\",\r\n        purchase_units: [\r\n          {\r\n            reference_id: orderId,\r\n            amount: {\r\n              currency_code: \"EUR\",\r\n              value: String(Number(totalEur).toFixed(2)),\r\n            },\r\n          },\r\n        ],\r\n      }),\r\n    });\r\n\r\n    const data = await res.json();\r\n    if (!res.ok) throw new Error(data?.message || \"PayPal create order error\");\r\n\r\n    return {\r\n      statusCode: 200,\r\n      body: JSON.stringify({ paypalOrderId: data.id }),\r\n    };\r\n  } catch (e) {\r\n    return { statusCode: 400, body: JSON.stringify({ error: e.message }) };\r\n  }\r\n};\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAM,OACJ,QAAQ,IAAI,eAAe,SACvB,6BACA;AAEN,eAAe,iBAAiB;AAC9B,QAAM,SAAS,QAAQ,IAAI;AAC3B,QAAM,SAAS,QAAQ,IAAI;AAE3B,QAAM,OAAO,OAAO,KAAK,GAAG,MAAM,IAAI,MAAM,EAAE,EAAE,SAAS,QAAQ;AAEjE,QAAM,MAAM,MAAM,MAAM,GAAG,IAAI,oBAAoB;AAAA,IACjD,QAAQ;AAAA,IACR,SAAS;AAAA,MACP,eAAe,SAAS,IAAI;AAAA,MAC5B,gBAAgB;AAAA,IAClB;AAAA,IACA,MAAM;AAAA,EACR,CAAC;AAED,QAAM,OAAO,MAAM,IAAI,KAAK;AAC5B,MAAI,CAAC,IAAI,GAAI,OAAM,IAAI,MAAM,MAAM,qBAAqB,oBAAoB;AAC5E,SAAO,KAAK;AACd;AAEO,IAAM,UAAU,OAAO,UAAU;AACtC,MAAI;AACF,UAAM,EAAE,SAAS,SAAS,IAAI,KAAK,MAAM,MAAM,QAAQ,IAAI;AAC3D,QAAI,CAAC,QAAS,OAAM,IAAI,MAAM,iBAAiB;AAC/C,QAAI,CAAC,SAAU,OAAM,IAAI,MAAM,kBAAkB;AAEjD,UAAM,cAAc,MAAM,eAAe;AAEzC,UAAM,MAAM,MAAM,MAAM,GAAG,IAAI,uBAAuB;AAAA,MACpD,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,eAAe,UAAU,WAAW;AAAA,QACpC,gBAAgB;AAAA,MAClB;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,QAAQ;AAAA,QACR,gBAAgB;AAAA,UACd;AAAA,YACE,cAAc;AAAA,YACd,QAAQ;AAAA,cACN,eAAe;AAAA,cACf,OAAO,OAAO,OAAO,QAAQ,EAAE,QAAQ,CAAC,CAAC;AAAA,YAC3C;AAAA,UACF;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAED,UAAM,OAAO,MAAM,IAAI,KAAK;AAC5B,QAAI,CAAC,IAAI,GAAI,OAAM,IAAI,MAAM,MAAM,WAAW,2BAA2B;AAEzE,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,MAAM,KAAK,UAAU,EAAE,eAAe,KAAK,GAAG,CAAC;AAAA,IACjD;AAAA,EACF,SAAS,GAAG;AACV,WAAO,EAAE,YAAY,KAAK,MAAM,KAAK,UAAU,EAAE,OAAO,EAAE,QAAQ,CAAC,EAAE;AAAA,EACvE;AACF;",
  "names": []
}
